* fixed possible corner case bugs in the authentication code
